!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).SimpleMarkdown=t()}(this,function(){"use strict";var s,l,t,n,r,d,h,e,a=/\r\n?/g,o=/\t/g,u=/\f/g,c=function(e){return e.replace(a,"\n").replace(u,"").replace(o,"    ")},i=function(e,t){var n=e||{};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n},f=function(m,n){var y,g=Object.keys(m).filter(function(e){var t=m[e];if(null==t||null==t.match)return!1;var n=t.order;return"number"==typeof n&&isFinite(n)||"undefined"==typeof console||console.warn("simple-markdown: Invalid order for rule `"+e+"`: "+String(n)),!0});g.sort(function(e,t){var n=m[e],r=m[t],a=n.order,o=r.order;if(a!==o)return a-o;var u=n.quality?0:1,l=r.quality?0:1;return u!==l?u-l:e<t?-1:t<e?1:0});var v=function(e,t){var n=[];for(y=t=t||y;e;){var r=null,a=null,o=null,u=NaN,l=0,c=g[0],i=m[c];do{var f=i.order,p=null==t.prevCapture?"":t.prevCapture[0],s=i.match(e,t,p);if(s){var d=i.quality?i.quality(s,t,p):0;d<=u||(r=c,a=i,o=s,u=d)}c=g[++l],i=m[c]}while(i&&(!o||i.order===f&&i.quality));if(null==a||null==o)throw new Error("Could not find a matching rule for the below content. The rule with highest `order` should always match content provided to it. Check the definition of `match` for '"+g[g.length-1]+"'. It seems to not match the following source:\n"+e);if(o.index)throw new Error("`match` must return a capture starting at index 0 (the current parse index). Did you forget a ^ at the start of the RegExp?");var h=a.parse(o,v,t);Array.isArray(h)?Array.prototype.push.apply(n,h):(null==h.type&&(h.type=r),n.push(h)),t.prevCapture=o,e=e.substring(t.prevCapture[0].length)}return n};return function(e,t){return(y=i(t,n)).inline||y.disableAutoBlockNewlines||(e+="\n\n"),y.prevCapture=null,v(c(e),y)}},p=function(n){var e=function(e,t){return t.inline?n.exec(e):null};return e.regex=n,e},m=function(n){var e=function(e,t){return t.inline?null:n.exec(e)};return e.regex=n,e},y=function(n){var e=function(e,t){return n.exec(e)};return e.regex=n,e},g="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,v=function(e,t,n){return{$$typeof:g,type:e,key:null==t?void 0:t,ref:null,props:n,_owner:null}},k=function(e,t,n,r){n=n||{},r=void 0===r||r;var a="";for(var o in n){var u=n[o];Object.prototype.hasOwnProperty.call(n,o)&&u&&(a+=" "+E(o)+'="'+E(u)+'"')}var l="<"+e+a+">";return r?l+t+"</"+e+">":l},x={},w=function(e){if(null==e)return null;try{var t=decodeURIComponent(e).replace(/[^A-Za-z0-9/:]/g,"").toLowerCase();if(0===t.indexOf("javascript:")||0===t.indexOf("vbscript:")||0===t.indexOf("data:"))return null}catch(e){return null}return e},b=/[<>&"']/g,_={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#x27;","/":"&#x2F;","`":"&#96;"},E=function(e){return String(e).replace(b,function(e){return _[e]})},S=/\\([^0-9A-Za-z\s])/g,A=function(e){return e.replace(S,"$1")},R=function(e,t,n){var r=n.inline||!1;n.inline=!0;var a=e(t,n);return n.inline=r,a},$=function(e,t,n){return{content:R(t,e[1],n)}},O=function(){return{}},T="(?:[*+-]|\\d+\\.)",j="( *)("+T+") +",C=new RegExp("^"+j),P=new RegExp(j+"[^\\n]*(?:\\n(?!\\1"+T+" )[^\\n]*)*(\n|$)","gm"),q=/\n{2,}$/,F=/^ (?= *`)|(` *) $/g,B=q,N=/ *\n+$/,I=new RegExp("^( *)("+T+") [\\s\\S]+?(?:\n{2,}(?! )(?!\\1"+T+" )\\n*|\\s*\n*$)"),L=/(?:^|\n)( *)$/,z=(s=/^ *\| *| *\| *$/g,l=/ *$/,t=/^ *-+: *$/,n=/^ *:-+: *$/,r=/^ *:-+ *$/,d=function(e){return t.test(e)?"right":n.test(e)?"center":r.test(e)?"left":null},h=function(e,t,n,r){var a=n.inTable;n.inTable=!0;var o=t(e.trim(),n);n.inTable=a;var u=[[]];return o.forEach(function(e,t){"tableSeparator"===e.type?(!r||0!==t&&t!==o.length-1)&&u.push([]):("text"!==e.type||null!=o[t+1]&&"tableSeparator"!==o[t+1].type||(e.content=e.content.replace(l,"")),u[u.length-1].push(e))}),u},{parseTable:(e=function(p){return function(e,t,n){n.inline=!0;var r,a,o,u,l,c=h(e[1],t,n,p),i=(r=e[2],p&&(r=r.replace(s,"")),r.trim().split("|").map(d)),f=(a=e[3],o=t,u=n,l=p,a.trim().split("\n").map(function(e){return h(e,o,u,l)}));return n.inline=!1,{type:"table",header:c,align:i,cells:f}}})(!0),parseNpTable:e(!1),TABLE_REGEX:/^ *(\|.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/,NPTABLE_REGEX:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/}),G="(?:\\[[^\\]]*\\]|[^\\[\\]]|\\](?=[^\\[]*\\]))*",X="\\s*<?((?:\\([^)]*\\)|[^\\s\\\\]|\\\\.)*?)>?(?:\\s+['\"]([\\s\\S]*?)['\"])?\\s*",Z=/mailto:/i,U=function(e,t,n){var r=(e[2]||e[1]).replace(/\s+/g," ").toLowerCase();if(t._defs&&t._defs[r]){var a=t._defs[r];n.target=a.target,n.title=a.title}return t._refs=t._refs||{},t._refs[r]=t._refs[r]||[],t._refs[r].push(n),n},H=0,M={Array:{react:function(e,t,n){for(var r=n.key,a=[],o=0,u=0;o<e.length;o++,u++){n.key=""+o;var l=e[o];if("text"===l.type)for(l={type:"text",content:l.content};o+1<e.length&&"text"===e[o+1].type;o++)l.content+=e[o+1].content;a.push(t(l,n))}return n.key=r,a},html:function(e,t,n){for(var r="",a=0;a<e.length;a++){var o=e[a];if("text"===o.type)for(o={type:"text",content:o.content};a+1<e.length&&"text"===e[a+1].type;a++)o.content+=e[a+1].content;r+=t(o,n)}return r}},heading:{order:H++,match:m(/^ *(#{1,6})([^\n]+?)#* *(?:\n *)+\n/),parse:function(e,t,n){return{level:e[1].length,content:R(t,e[2].trim(),n)}},react:function(e,t,n){return v("h"+e.level,n.key,{children:t(e.content,n)})},html:function(e,t,n){return k("h"+e.level,t(e.content,n))}},nptable:{order:H++,match:m(z.NPTABLE_REGEX),parse:z.parseNpTable,react:null,html:null},lheading:{order:H++,match:m(/^([^\n]+)\n *(=|-){3,} *(?:\n *)+\n/),parse:function(e,t,n){return{type:"heading",level:"="===e[2]?1:2,content:R(t,e[1],n)}},react:null,html:null},hr:{order:H++,match:m(/^( *[-*_]){3,} *(?:\n *)+\n/),parse:O,react:function(e,t,n){return v("hr",n.key,x)},html:function(e,t,n){return"<hr>"}},codeBlock:{order:H++,match:m(/^(?:    [^\n]+\n*)+(?:\n *)+\n/),parse:function(e,t,n){return{lang:void 0,content:e[0].replace(/^    /gm,"").replace(/\n+$/,"")}},react:function(e,t,n){var r=e.lang?"markdown-code-"+e.lang:void 0;return v("pre",n.key,{children:v("code",null,{className:r,children:e.content})})},html:function(e,t,n){var r=e.lang?"markdown-code-"+e.lang:void 0,a=k("code",E(e.content),{class:r});return k("pre",a)}},fence:{order:H++,match:m(/^ *(`{3,}|~{3,}) *(?:(\S+) *)?\n([\s\S]+?)\n?\1 *(?:\n *)+\n/),parse:function(e,t,n){return{type:"codeBlock",lang:e[2]||void 0,content:e[3]}},react:null,html:null},blockQuote:{order:H++,match:m(/^( *>[^\n]+(\n[^\n]+)*\n*)+\n{2,}/),parse:function(e,t,n){return{content:t(e[0].replace(/^ *> ?/gm,""),n)}},react:function(e,t,n){return v("blockquote",n.key,{children:t(e.content,n)})},html:function(e,t,n){return k("blockquote",t(e.content,n))}},list:{order:H++,match:function(e,t){var n=null==t.prevCapture?"":t.prevCapture[0],r=L.exec(n),a=t._list||!t.inline;return r&&a?(e=r[1]+e,I.exec(e),I.exec(e)):null},parse:function(e,s,d){var t=e[2],n=1<t.length,r=n?+t:void 0,h=e[0].replace(B,"\n").match(P),m=!1;return{ordered:n,start:r,items:h.map(function(e,t){var n=C.exec(e),r=n?n[0].length:0,a=new RegExp("^ {1,"+r+"}","gm"),o=e.replace(a,"").replace(C,""),u=t===h.length-1,l=-1!==o.indexOf("\n\n")||u&&m;m=l;var c,i=d.inline,f=d._list;d._list=!0,c=l?(d.inline=!1,o.replace(N,"\n\n")):(d.inline=!0,o.replace(N,""));var p=s(c,d);return d.inline=i,d._list=f,p})}},react:function(e,n,r){var t=e.ordered?"ol":"ul";return v(t,r.key,{start:e.start,children:e.items.map(function(e,t){return v("li",""+t,{children:n(e,r)})})})},html:function(e,t,n){var r=e.items.map(function(e){return k("li",t(e,n))}).join(""),a=e.ordered?"ol":"ul",o={start:e.start};return k(a,r,o)}},def:{order:H++,match:m(/^ *\[([^\]]+)\]: *<?([^\s>]*)>?(?: +["(]([^\n]+)[")])? *\n(?: *\n)*/),parse:function(e,t,n){var r=e[1].replace(/\s+/g," ").toLowerCase(),a=e[2],o=e[3];return n._refs&&n._refs[r]&&n._refs[r].forEach(function(e){e.target=a,e.title=o}),n._defs=n._defs||{},n._defs[r]={target:a,title:o},{def:r,target:a,title:o}},react:function(){return null},html:function(){return""}},table:{order:H++,match:m(z.TABLE_REGEX),parse:z.parseTable,react:function(t,n,r){var a=function(e){return null==t.align[e]?{}:{textAlign:t.align[e]}},e=t.header.map(function(e,t){return v("th",""+t,{style:a(t),scope:"col",children:n(e,r)})}),o=t.cells.map(function(e,t){return v("tr",""+t,{children:e.map(function(e,t){return v("td",""+t,{style:a(t),children:n(e,r)})})})});return v("table",r.key,{children:[v("thead","thead",{children:v("tr",null,{children:e})}),v("tbody","tbody",{children:o})]})},html:function(t,n,r){var a=function(e){return null==t.align[e]?"":"text-align:"+t.align[e]+";"},e=t.header.map(function(e,t){return k("th",n(e,r),{style:a(t),scope:"col"})}).join(""),o=t.cells.map(function(e){var t=e.map(function(e,t){return k("td",n(e,r),{style:a(t)})}).join("");return k("tr",t)}).join(""),u=k("thead",k("tr",e)),l=k("tbody",o);return k("table",u+l)}},newline:{order:H++,match:m(/^(?:\n *)*\n/),parse:O,react:function(e,t,n){return"\n"},html:function(e,t,n){return"\n"}},paragraph:{order:H++,match:m(/^((?:[^\n]|\n(?! *\n))+)(?:\n *)+\n/),parse:$,react:function(e,t,n){return v("div",n.key,{className:"paragraph",children:t(e.content,n)})},html:function(e,t,n){return k("div",t(e.content,n),{class:"paragraph"})}},escape:{order:H++,match:p(/^\\([^0-9A-Za-z\s])/),parse:function(e,t,n){return{type:"text",content:e[1]}},react:null,html:null},tableSeparator:{order:H++,match:function(e,t){return t.inTable?/^ *\| */.exec(e):null},parse:function(){return{type:"tableSeparator"}},react:function(){return" | "},html:function(){return" &vert; "}},autolink:{order:H++,match:p(/^<([^: >]+:\/[^ >]+)>/),parse:function(e,t,n){return{type:"link",content:[{type:"text",content:e[1]}],target:e[1]}},react:null,html:null},mailto:{order:H++,match:p(/^<([^ >]+@[^ >]+)>/),parse:function(e,t,n){var r=e[1],a=e[1];return Z.test(a)||(a="mailto:"+a),{type:"link",content:[{type:"text",content:r}],target:a}},react:null,html:null},url:{order:H++,match:p(/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/),parse:function(e,t,n){return{type:"link",content:[{type:"text",content:e[1]}],target:e[1],title:void 0}},react:null,html:null},link:{order:H++,match:p(new RegExp("^\\[("+G+")\\]\\("+X+"\\)")),parse:function(e,t,n){return{content:t(e[1],n),target:A(e[2]),title:e[3]}},react:function(e,t,n){return v("a",n.key,{href:w(e.target),title:e.title,children:t(e.content,n)})},html:function(e,t,n){var r={href:w(e.target),title:e.title};return k("a",t(e.content,n),r)}},image:{order:H++,match:p(new RegExp("^!\\[("+G+")\\]\\("+X+"\\)")),parse:function(e,t,n){return{alt:e[1],target:A(e[2]),title:e[3]}},react:function(e,t,n){return v("img",n.key,{src:w(e.target),alt:e.alt,title:e.title})},html:function(e,t,n){var r={src:w(e.target),alt:e.alt,title:e.title};return k("img","",r,!1)}},reflink:{order:H++,match:p(new RegExp("^\\[("+G+")\\]\\s*\\[([^\\]]*)\\]")),parse:function(e,t,n){return U(e,n,{type:"link",content:t(e[1],n)})},react:null,html:null},refimage:{order:H++,match:p(new RegExp("^!\\[("+G+")\\]\\s*\\[([^\\]]*)\\]")),parse:function(e,t,n){return U(e,n,{type:"image",alt:e[1]})},react:null,html:null},em:{order:H,match:p(new RegExp("^\\b_((?:__|\\\\[\\s\\S]|[^\\\\_])+?)_\\b|^\\*(?=\\S)((?:\\*\\*|\\\\[\\s\\S]|\\s+(?:\\\\[\\s\\S]|[^\\s\\*\\\\]|\\*\\*)|[^\\s\\*\\\\])+?)\\*(?!\\*)")),quality:function(e){return e[0].length+.2},parse:function(e,t,n){return{content:t(e[2]||e[1],n)}},react:function(e,t,n){return v("em",n.key,{children:t(e.content,n)})},html:function(e,t,n){return k("em",t(e.content,n))}},strong:{order:H,match:p(/^\*\*((?:\\[\s\S]|[^\\])+?)\*\*(?!\*)/),quality:function(e){return e[0].length+.1},parse:$,react:function(e,t,n){return v("strong",n.key,{children:t(e.content,n)})},html:function(e,t,n){return k("strong",t(e.content,n))}},u:{order:H++,match:p(/^__((?:\\[\s\S]|[^\\])+?)__(?!_)/),quality:function(e){return e[0].length},parse:$,react:function(e,t,n){return v("u",n.key,{children:t(e.content,n)})},html:function(e,t,n){return k("u",t(e.content,n))}},del:{order:H++,match:p(/^~~(?=\S)((?:\\[\s\S]|~(?!~)|[^\s~]|\s(?!~~))+?)~~/),parse:$,react:function(e,t,n){return v("del",n.key,{children:t(e.content,n)})},html:function(e,t,n){return k("del",t(e.content,n))}},inlineCode:{order:H++,match:p(/^(`+)([\s\S]*?[^`])\1(?!`)/),parse:function(e,t,n){return{content:e[2].replace(F,"$1")}},react:function(e,t,n){return v("code",n.key,{children:e.content})},html:function(e,t,n){return k("code",E(e.content))}},br:{order:H++,match:y(/^ {2,}\n/),parse:O,react:function(e,t,n){return v("br",n.key,x)},html:function(e,t,n){return"<br>"}},text:{order:H++,match:y(/^[\s\S]+?(?=[^0-9A-Za-z\s\u00c0-\uffff]|\n\n| {2,}\n|\w+:\S|$)/),parse:function(e,t,n){return{content:e[0]}},react:function(e,t,n){return e.content},html:function(e,t,n){return E(e.content)}}},D=function(n,r,a){if(!r)throw new Error("simple-markdown: outputFor: `property` must be defined. if you just upgraded, you probably need to replace `outputFor` with `reactFor`");var o,e=(n.Array||M.Array)[r];if(!e)throw new Error("simple-markdown: outputFor: to join nodes of type `"+r+"` you must provide an `Array:` joiner rule with that type, Please see the docs for details on specifying an Array rule.");var u=e,l=function(e,t){return o=t=t||o,Array.isArray(e)?u(e,l,t):n[e.type][r](e,l,t)};return function(e,t){return o=i(t,a),l(e,o)}},Q=f(M),J=function(e,t){return(t=t||{}).inline=!1,Q(e,t)},K=function(e,t){var n=q.test(e);return(t=t||{}).inline=!n,Q(e,t)},V=D(M,"react"),W=D(M,"html"),Y=function(e,t){return V(J(e,t),t)};return{defaultRules:M,parserFor:f,outputFor:D,inlineRegex:p,blockRegex:m,anyScopeRegex:y,parseInline:R,parseBlock:function(e,t,n){var r=n.inline||!1;n.inline=!1;var a=e(t+"\n\n",n);return n.inline=r,a},markdownToReact:Y,markdownToHtml:function(e,t){return W(J(e,t),t)},ReactMarkdown:function(e){var t={};for(var n in e)"source"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.children=Y(e.source),v("div",null,t)},defaultBlockParse:J,defaultInlineParse:function(e,t){return(t=t||{}).inline=!0,Q(e,t)},defaultImplicitParse:K,defaultReactOutput:V,defaultHtmlOutput:W,preprocess:c,sanitizeText:E,sanitizeUrl:w,unescapeUrl:A,htmlTag:k,reactElement:v,defaultRawParse:Q,ruleOutput:function(r,a){return a||"undefined"==typeof console||console.warn("simple-markdown ruleOutput should take 'react' or 'html' as the second argument."),function(e,t,n){return r[e.type][a](e,t,n)}},reactFor:function(l){var c=function(e,t){if(t=t||{},Array.isArray(e)){for(var n=t.key,r=[],a=null,o=0;o<e.length;o++){t.key=""+o;var u=c(e[o],t);"string"==typeof u&&"string"==typeof a?(a+=u,r[r.length-1]=a):(r.push(u),a=u)}return t.key=n,r}return l(e,c,t)};return c},htmlFor:function(n){var r=function(e,t){return t=t||{},Array.isArray(e)?e.map(function(e){return r(e,t)}).join(""):n(e,r,t)};return r},defaultParse:function(){return"undefined"!=typeof console&&console.warn("defaultParse is deprecated, please use `defaultImplicitParse`"),K.apply(null,arguments)},defaultOutput:function(){return"undefined"!=typeof console&&console.warn("defaultOutput is deprecated, please use `defaultReactOutput`"),V.apply(null,arguments)}}});